---
layout: 
title: "DNH SÁCH BÀI HÁT"
permalink: /songs
description: "Hiển thị các bài hát karaoke đã được chọn để hát. Dễ dàng truy cập và quản lý các lựa chọn yêu thích của bạn."
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>YouTube Player with Firebase Sync</title>
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-database.js"></script>
  <script src="https://www.youtube.com/iframe_api"></script>
</head>
<body>
  <h1>Karaoke Player with Real-time Sync</h1>

  <!-- YouTube Video IFrame -->
  <div id="player"></div>

  <!-- Video control buttons -->
  <div>
    <button id="playBtn">Play</button>
    <button id="pauseBtn">Pause</button>
    <button id="volumeUpBtn">Volume Up</button>
    <button id="volumeDownBtn">Volume Down</button>
    <button id="nextBtn">Next</button>
    <button id="priorityBtn">Priority</button>
    <button id="replayBtn">Replay</button>
  </div>

  <script>
    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyBBPKJcXjkZ0wUbXNremQuf_R1Z6baYcU0",
      authDomain: "karaoke-3aa8f.firebaseapp.com",
      databaseURL: "https://karaoke-3aa8f-default-rtdb.asia-southeast1.firebasedatabase.app/",
      projectId: "karaoke-3aa8f",
      storageBucket: "karaoke-3aa8f.appspot.com",
      messagingSenderId: "652741363415",
      appId: "1:652741363415:web:e33bb49a0be7eed7e09292",
      measurementId: "G-MNBY4YPT3N"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    let player;
    let isSyncing = false;

    // Initialize YouTube IFrame API
    function onYouTubeIframeAPIReady() {
      player = new YT.Player('player', {
        height: '390',
        width: '640',
        videoId: 'rM5iazNj9mw',  // Default video ID
        playerVars: { start: 0 },
        events: {
          'onReady': onPlayerReady,
          'onStateChange': onPlayerStateChange
        }
      });
    }

    // Sync video state with Firebase
    function syncVideoWithFirebase() {
      const videoRef = database.ref('videoState');

      // Listen for changes in Firebase to sync all clients
      videoRef.on('value', (snapshot) => {
        const data = snapshot.val();
        if (data && !isSyncing) {
          isSyncing = true;
          if (data.currentVideoId && data.currentVideoId !== player.getVideoData().video_id) {
            player.loadVideoById(data.currentVideoId, data.currentTime);
          } else {
            player.seekTo(data.currentTime, true);
            if (data.isPlaying) {
              player.playVideo();
            } else {
              player.pauseVideo();
            }
          }
          isSyncing = false;
        }
      });
    }

    // Update Firebase with current video state
    function updateFirebase() {
      if (!isSyncing) {
        database.ref('videoState').set({
          currentVideoId: player.getVideoData().video_id,
          currentTime: player.getCurrentTime(),
          isPlaying: player.getPlayerState() === YT.PlayerState.PLAYING
        });
      }
    }

    // Player ready handler
    function onPlayerReady(event) {
      syncVideoWithFirebase();
    }

    // Player state change handler
    function onPlayerStateChange(event) {
      if (event.data === YT.PlayerState.PLAYING || event.data === YT.PlayerState.PAUSED) {
        updateFirebase();
      }
    }

    // Video controls
    document.getElementById('playBtn').addEventListener('click', () => {
      player.playVideo();
      updateFirebase();
    });
    document.getElementById('pauseBtn').addEventListener('click', () => {
      player.pauseVideo();
      updateFirebase();
    });
    document.getElementById('volumeUpBtn').addEventListener('click', () => player.setVolume(player.getVolume() + 10));
    document.getElementById('volumeDownBtn').addEventListener('click', () => player.setVolume(player.getVolume() - 10));
    document.getElementById('nextBtn').addEventListener('click', () => alert('Next button not implemented yet'));
    document.getElementById('priorityBtn').addEventListener('click', () => alert('Priority button not implemented yet'));
    document.getElementById('replayBtn').addEventListener('click', () => {
      player.seekTo(0);
      updateFirebase();
    });
  </script>
</body>
</html>




